import{animate}from"../animate/index.js";const MODULE_BASE="collapse",ATTRIBUTE_BASE="data-w-"+MODULE_BASE,ATTRIBUTE_BASE_ID=ATTRIBUTE_BASE+"-id",ATTRIBUTE_BASE_ACTIVE=ATTRIBUTE_BASE+"-active",ATTRIBUTE_CONTROL=ATTRIBUTE_BASE+"-control",ATTRIBUTE_CONTROL_ACTIVE=ATTRIBUTE_CONTROL+"-active",ATTRIBUTE_ACTION=ATTRIBUTE_BASE+"-action",ATTRIBUTE_ACTION_ARGS=ATTRIBUTE_ACTION+"-args",ATTRIBUTE_ACTION_FLUSH=ATTRIBUTE_ACTION+"-flush";class Collapse{spAc=["hide","show","toggle"];element;an=null;constructor({element:t}){this.el=t,document.addEventListener("click",this.hDC)}hDC=t=>{let e=t["target"];var T,i;if(e&&(e=e.closest(`[${ATTRIBUTE_BASE_ID}="${this.el.getAttribute(""+ATTRIBUTE_BASE_ID)}"][${ATTRIBUTE_CONTROL}][${ATTRIBUTE_ACTION}]`)))return i=e.getAttribute(ATTRIBUTE_ACTION),T=e.getAttribute(ATTRIBUTE_ACTION_ARGS),e.getAttribute(ATTRIBUTE_ACTION_FLUSH)||t.preventDefault(),i&&this.spAc.includes(i)&&(i=this[i])instanceof Function?i({args:T,event:t}):void 0};show=async({}={})=>{this.an&&clearTimeout(this.an.timer),null==this.el.getAttribute(ATTRIBUTE_BASE_ACTIVE)&&(document.querySelectorAll(`[${ATTRIBUTE_BASE_ID}="${this.el.getAttribute(""+ATTRIBUTE_BASE_ID)}"][${ATTRIBUTE_CONTROL}][${ATTRIBUTE_ACTION}]`).forEach(t=>{t.setAttribute(ATTRIBUTE_CONTROL_ACTIVE,"")}),this.el.style.height="0px",this.el.setAttribute(ATTRIBUTE_BASE_ACTIVE,""),this.el.scrollHeight,this.an=animate({element:this.el,callback:()=>{this.el.style.height=this.el.scrollHeight+"px"}}),await this.an?.promise,this.el.style.removeProperty("height"),this.an=null)};hide=async({}={})=>{this.an&&clearTimeout(this.an.timer),null!=this.el.getAttribute(ATTRIBUTE_BASE_ACTIVE)&&(this.el.style.height=this.el.scrollHeight+"px",this.el.style.display="block",this.an=animate({element:this.el,callback:()=>{this.el.style.height=this.el.scrollHeight+"px",this.el.removeAttribute(ATTRIBUTE_BASE_ACTIVE),document.querySelectorAll(`[${ATTRIBUTE_BASE_ID}="${this.el.getAttribute(""+ATTRIBUTE_BASE_ID)}"][${ATTRIBUTE_CONTROL}][${ATTRIBUTE_ACTION}]`).forEach(t=>{t.removeAttribute(ATTRIBUTE_CONTROL_ACTIVE)}),this.el.style.height="0px"}}),await this.an?.promise,this.el.style.removeProperty("display"),this.el.style.removeProperty("height"),this.an=null)};toggle=async({args:t,event:e}={})=>(this.an&&clearTimeout(this.an.timer),null!=this.el.getAttribute(ATTRIBUTE_BASE_ACTIVE)?this.hide({args:t,event:e}):this.show({args:t,event:e}))}export{Collapse as collapse};
//# sourceMappingURL=index.min.js.map