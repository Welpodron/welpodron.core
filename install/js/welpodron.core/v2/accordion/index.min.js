import{animate}from"../animate/index.js";const MODULE_BASE="accordion",ATTRIBUTE_BASE="data-w-"+MODULE_BASE,ATTRIBUTE_BASE_ID=ATTRIBUTE_BASE+"-id",ATTRIBUTE_ITEM=ATTRIBUTE_BASE+"-item",ATTRIBUTE_ITEM_ID=ATTRIBUTE_ITEM+"-id",ATTRIBUTE_ITEM_ACTIVE=ATTRIBUTE_ITEM+"-active",ATTRIBUTE_CONTROL=ATTRIBUTE_BASE+"-control",ATTRIBUTE_CONTROL_ACTIVE=ATTRIBUTE_CONTROL+"-active",ATTRIBUTE_ACTION=ATTRIBUTE_BASE+"-action",ATTRIBUTE_ACTION_ARGS=ATTRIBUTE_ACTION+"-args",ATTRIBUTE_ACTION_FLUSH=ATTRIBUTE_ACTION+"-flush";class AccordionItem{spAc=["hide","show"];accordion;el;an=null;constructor({element:t,accordion:e}){this.el=t,this.accordion=e}show=async({}={})=>{this.an&&clearTimeout(this.an.timer),null==this.el.getAttribute(ATTRIBUTE_ITEM_ACTIVE)&&(this.el.style.height="0px",this.el.setAttribute(ATTRIBUTE_ITEM_ACTIVE,""),document.querySelectorAll(`[${ATTRIBUTE_ACTION_ARGS}="${this.el.getAttribute(""+ATTRIBUTE_ITEM_ID)}"]`).forEach(t=>{t.setAttribute(ATTRIBUTE_CONTROL_ACTIVE,"")}),this.el.scrollHeight,this.an=animate({element:this.el,callback:()=>{this.el.style.height=this.el.scrollHeight+"px"}}),await this.an?.promise,this.el.style.removeProperty("height"),this.an=null)};hide=async({}={})=>{this.an&&clearTimeout(this.an.timer),null!=this.el.getAttribute(ATTRIBUTE_ITEM_ACTIVE)&&(this.el.style.height=this.el.scrollHeight+"px",this.el.style.display="block",this.an=animate({element:this.el,callback:()=>{this.el.style.height=this.el.scrollHeight+"px",this.el.removeAttribute(ATTRIBUTE_ITEM_ACTIVE),document.querySelectorAll(`[${ATTRIBUTE_ACTION_ARGS}="${this.el.getAttribute(""+ATTRIBUTE_ITEM_ID)}"]`).forEach(t=>{t.removeAttribute(ATTRIBUTE_CONTROL_ACTIVE)}),this.el.style.height="0px"}}),await this.an?.promise,this.el.style.removeProperty("display"),this.el.style.removeProperty("height"),this.an=null)}}class Accordion{spAc=["show"];element;constructor({element:t}){this.el=t,document.addEventListener("click",this.hDC)}hDC=t=>{let e=t["target"];var T,i;if(e&&(e=e.closest(`[${ATTRIBUTE_BASE_ID}="${this.el.getAttribute(""+ATTRIBUTE_BASE_ID)}"][${ATTRIBUTE_CONTROL}][${ATTRIBUTE_ACTION}]`)))return i=e.getAttribute(ATTRIBUTE_ACTION),T=e.getAttribute(ATTRIBUTE_ACTION_ARGS),e.getAttribute(ATTRIBUTE_ACTION_FLUSH)||t.preventDefault(),i&&this.spAc.includes(i)&&(i=this[i])instanceof Function?i({args:T,event:t}):void 0};show=async({args:e,event:t})=>{if(e){var T=this.el.getAttribute(ATTRIBUTE_BASE_ID);if(T){T=this.el.querySelectorAll(`[${ATTRIBUTE_BASE_ID}="${T}"][${ATTRIBUTE_ITEM_ID}]`);if(T){var i=[...T].find(t=>t.getAttribute(ATTRIBUTE_ITEM_ID)===e);if(i){var A,s=[];for(A of T){var l=new AccordionItem({element:A,accordion:this});A===i?s.push(l.show({args:e,event:t})):s.push(l.hide({args:e,event:t}))}await Promise.allSettled(s)}}}}}}export{Accordion as accordion,AccordionItem as accordionItem};
//# sourceMappingURL=index.min.js.map